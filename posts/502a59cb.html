<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>统计软件 R 语言学习笔记 (4) R 语言初步：自定义函数、简单模拟与数据清洗 | isKage`Blog</title><meta name="author" content="isKage"><meta name="copyright" content="isKage"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本章介绍 R 语言的函数定义方法，以及进行统计模拟、数据清洗的方法。&#96;function&#96; 关键字自定义函数；&#96;r*&#96; &#96;p*&#96; &#96;d*&#96; &#96;q*&#96; 分别进行各种分布的模拟；&#96;sample&#96; 函数进行简单随机抽样；数据清洗包括了缺失数据处理、按行排序、选取&#x2F;删除部分数据、添加变量&#x2F;特征和合并数据集操作。">
<meta property="og:type" content="article">
<meta property="og:title" content="统计软件 R 语言学习笔记 (4) R 语言初步：自定义函数、简单模拟与数据清洗">
<meta property="og:url" content="https://blog.iskage.online/posts/502a59cb.html">
<meta property="og:site_name" content="isKage&#96;Blog">
<meta property="og:description" content="本章介绍 R 语言的函数定义方法，以及进行统计模拟、数据清洗的方法。&#96;function&#96; 关键字自定义函数；&#96;r*&#96; &#96;p*&#96; &#96;d*&#96; &#96;q*&#96; 分别进行各种分布的模拟；&#96;sample&#96; 函数进行简单随机抽样；数据清洗包括了缺失数据处理、按行排序、选取&#x2F;删除部分数据、添加变量&#x2F;特征和合并数据集操作。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg">
<meta property="article:published_time" content="2025-03-13T09:07:00.000Z">
<meta property="article:modified_time" content="2025-04-17T08:09:56.546Z">
<meta property="article:author" content="isKage">
<meta property="article:tag" content="R 语言">
<meta property="article:tag" content="统计软件">
<meta property="article:tag" content="R programming">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg"><link rel="shortcut icon" href="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/avatar_new.PNG"><link rel="canonical" href="https://blog.iskage.online/posts/502a59cb.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: isKage","link":"链接: ","source":"来源: isKage`Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '统计软件 R 语言学习笔记 (4) R 语言初步：自定义函数、简单模拟与数据清洗',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="isKage`Blog" type="application/atom+xml">
</head><body><div id="web_bg" style="background-image: url(https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/background.jpeg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/avatar_new.PNG" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">65</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw fas fa-home faa-tada"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw fas fa-folder-open faa-tada"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/tags/"><i class="fa-fw fas fa-tags faa-tada"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw fas fa-archive faa-tada"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw fas fa-link faa-tada"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">isKage`Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">统计软件 R 语言学习笔记 (4) R 语言初步：自定义函数、简单模拟与数据清洗</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw fas fa-home faa-tada"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw fas fa-folder-open faa-tada"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/tags/"><i class="fa-fw fas fa-tags faa-tada"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw fas fa-archive faa-tada"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw fas fa-link faa-tada"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">统计软件 R 语言学习笔记 (4) R 语言初步：自定义函数、简单模拟与数据清洗</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-13T09:07:00.000Z" title="发表于 2025-03-13 17:07:00">2025-03-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-17T08:09:56.546Z" title="更新于 2025-04-17 16:09:56">2025-04-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/R-%E8%AF%AD%E8%A8%80/">R 语言</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>R 语言初步 (3) 自定义函数、简单模拟与数据清洗</h1>
<p>本章介绍 R 语言的函数定义方法，以及进行统计模拟、数据清洗的方法。<code>function</code> 关键字自定义函数；<code>r*</code> <code>p*</code> <code>d*</code> <code>q*</code> 分别进行各种分布的模拟；<code>sample</code> 函数进行简单随机抽样；数据清洗包括了缺失数据处理、按行排序、选取/删除部分数据、添加变量/特征和合并数据集操作。</p>
<p>代码和笔记存储在 <a target="_blank" rel="noopener" href="https://github.com/iskage/r-notes">GitHub 库</a> <strong>【持续更新中，建议 star！】</strong></p>
<h2 id="1-自定义函数">1 自定义函数</h2>
<h3 id="1-1-函数定义">1.1 函数定义</h3>
<p>定义函数的一般形式：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">myfunction <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>a<span class="punctuation">,</span> b<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    statement</span><br><span class="line">    <span class="built_in">return</span><span class="punctuation">(</span>object<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>myfunction</code> ：自定义的函数名称</li>
<li><code>function()</code> ：关键字，告诉 R 语言这是自定义的函数</li>
<li><code>a, b, c</code> ：为函数的参数，表明函数需要传入的参数</li>
<li><code>statement</code> ：函数体，编写函数的操作</li>
<li><code>return(object)</code> ：函数的返回值</li>
</ul>
<h3 id="1-2-传参方式">1.2 传参方式</h3>
<ul>
<li>方式一：按照参数顺序逐个传入</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myfunction<span class="punctuation">(</span>x1<span class="punctuation">,</span> x2<span class="punctuation">,</span> x3<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>方式二：指定参数</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myfunction<span class="punctuation">(</span>a <span class="operator">=</span> x1<span class="punctuation">,</span> b <span class="operator">=</span> x2<span class="punctuation">,</span> <span class="built_in">c</span> <span class="operator">=</span> x3<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="1-3-示例">1.3 示例</h3>
<ul>
<li>函数名：<code>my.data.ana</code></li>
<li>输入：一个向量 <code>x</code></li>
<li>任务：计算向量的平均值、最大值、最小值</li>
<li>输出：一个列表储存的结果</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">my.data.ana <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    y <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>mean <span class="operator">=</span> mean<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">max</span> <span class="operator">=</span> <span class="built_in">max</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">min</span> <span class="operator">=</span> <span class="built_in">min</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    <span class="built_in">return</span><span class="punctuation">(</span>y<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">,</span> <span class="number">9</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">y <span class="operator">&lt;-</span> my.data.ana<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">y</span><br><span class="line"></span><br><span class="line"><span class="comment"># $mean</span></span><br><span class="line"><span class="comment"># [1] 5.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># $max</span></span><br><span class="line"><span class="comment"># [1] 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># $min</span></span><br><span class="line"><span class="comment"># [1] 1</span></span><br></pre></td></tr></table></figure>
<h2 id="2-简单模拟">2 简单模拟</h2>
<h3 id="2-1-有关统计分布的函数">2.1 有关统计分布的函数</h3>
<p><code>r*</code> ：<code>*</code> 分布的随机数函数</p>
<p><code>d*</code> ：<code>*</code> 分布的密度函数</p>
<p><code>p*</code> ：<code>*</code> 分布的分布函数</p>
<p><code>q*</code> ：<code>*</code> 分布的分位数函数</p>
<p>例如：</p>
<ul>
<li>正态分布的相关函数 <code>rnorm()</code> <code>dnorm()</code> <code>pnorm()</code> <code>qnorm()</code></li>
<li>Gamma 分布的相关函数 <code>rgamma()</code> <code>dgamma()</code> <code>pgamma()</code> <code>qgamma()</code></li>
<li>泊松分布相关函数 <code>rpois()</code> <code>dpois()</code> <code>ppois()</code> <code>qpois()</code></li>
</ul>
<h4 id="2-1-1-正态分布">2.1.1 正态分布</h4>
<p><strong>格式</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 传入分位数点，得到密度函数值</span></span><br><span class="line">dnorm<span class="punctuation">(</span>x<span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> <span class="built_in">log</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 传入分位数点，得到分布函数值/即概率</span></span><br><span class="line">pnorm<span class="punctuation">(</span>q<span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> lower.tail <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> log.p <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 传入概率值，得到对应的分位数点值</span></span><br><span class="line">qnorm<span class="punctuation">(</span>p<span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> lower.tail <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> log.p <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回 n 个随机数</span></span><br><span class="line">rnorm<span class="punctuation">(</span>n<span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>参数</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code> <code>q</code></td>
<td>分位数向量</td>
</tr>
<tr>
<td><code>p</code></td>
<td>概率值向量</td>
</tr>
<tr>
<td><code>n</code></td>
<td><code>rnorm(n)</code> 返回随机数的个数</td>
</tr>
<tr>
<td><code>mean</code></td>
<td>均值向量</td>
</tr>
<tr>
<td><code>sd</code></td>
<td>标准差向量</td>
</tr>
<tr>
<td><code>log</code> <code>log.p</code></td>
<td>是否取对数，为 <code>TRUE</code> ，则传入 <code>log(p)</code></td>
</tr>
<tr>
<td><code>lower.tail</code></td>
<td>为 <code>TRUE</code> ，则概率表达式为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo>≤</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(X \leq x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 否则，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo>&gt;</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(X &gt; x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></td>
</tr>
</tbody>
</table>
<h4 id="2-1-2-Poisson-分布">2.1.2 Poisson 分布</h4>
<p><strong>格式</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算概率密度函数 (PMF) 值</span></span><br><span class="line">dpois<span class="punctuation">(</span>x<span class="punctuation">,</span> lambda<span class="punctuation">,</span> <span class="built_in">log</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算累积分布函数 (CDF) 值</span></span><br><span class="line">ppois<span class="punctuation">(</span>q<span class="punctuation">,</span> lambda<span class="punctuation">,</span> lower.tail <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> log.p <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算分位数（逆 CDF）</span></span><br><span class="line">qpois<span class="punctuation">(</span>p<span class="punctuation">,</span> lambda<span class="punctuation">,</span> lower.tail <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> log.p <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成随机数</span></span><br><span class="line">rpois<span class="punctuation">(</span>n<span class="punctuation">,</span> lambda<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>参数</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code> <code>q</code></td>
<td>非负整数分位数点。若输入非整数，<code>dpois</code> 返回 0；<code>ppois</code> 自动取 <code>floor(q)</code> 计算。</td>
</tr>
<tr>
<td><code>p</code></td>
<td>概率值向量，范围必须在 [0, 1] 之间。</td>
</tr>
<tr>
<td><code>n</code></td>
<td>生成的随机数数量。</td>
</tr>
<tr>
<td><code>lambda</code></td>
<td>非负向量。若为负数，返回 <code>NaN</code>。</td>
</tr>
<tr>
<td><code>log</code> <code>log.p</code></td>
<td>逻辑值。若为 <code>TRUE</code>，概率以自然对数形式输入/输出。</td>
</tr>
<tr>
<td><code>lower.tail</code></td>
<td>逻辑值。若为 <code>TRUE</code>（默认），计算 <code>P(X ≤ x)</code> 或 <code>P(X ≤ q)</code>；否则计算 <code>P(X &gt; x)</code> 或 <code>P(X &gt; q)</code>。</td>
</tr>
</tbody>
</table>
<p><strong>关键细节</strong></p>
<ol>
<li>
<p><strong>离散性处理</strong><br>
• <code>dpois(x, lambda)</code> 仅在 <code>x</code> 为整数时返回非零值，否则返回 0。<br>
• <code>ppois(q, lambda)</code> 会对非整数 <code>q</code> 向下取整（等效计算 <code>P(X ≤ floor(q))</code>）。</p>
</li>
<li>
<p><strong>分位数函数逻辑</strong><br>
• <code>qpois(p, lambda)</code> 返回最小整数 <code>k</code>，使得 <code>P(X ≤ k) ≥ p</code>。<br>
• 当 <code>lower.tail = FALSE</code> 时，寻找最小 <code>k</code> 使得 <code>P(X &gt; k) ≤ p</code>（即右尾分位数）。</p>
</li>
<li>
<p><strong>向量化运算</strong><br>
所有参数均支持向量化输入，按元素循环计算。例如：</p>
</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># 分别计算 λ=2 时 x=1，λ=3 时 x=2，λ=4 时 x=3 的概率</span></span><br><span class="line">dpois<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> lambda <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="2-1-3-二项分布">2.1.3 二项分布</h4>
<p><strong>格式</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算概率密度函数 (PMF) 值</span></span><br><span class="line">dbinom<span class="punctuation">(</span>x<span class="punctuation">,</span> size<span class="punctuation">,</span> prob<span class="punctuation">,</span> <span class="built_in">log</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算累积分布函数 (CDF) 值</span></span><br><span class="line">pbinom<span class="punctuation">(</span>q<span class="punctuation">,</span> size<span class="punctuation">,</span> prob<span class="punctuation">,</span> lower.tail <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> log.p <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算分位数（逆 CDF）</span></span><br><span class="line">qbinom<span class="punctuation">(</span>p<span class="punctuation">,</span> size<span class="punctuation">,</span> prob<span class="punctuation">,</span> lower.tail <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> log.p <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成随机数</span></span><br><span class="line">rbinom<span class="punctuation">(</span>n<span class="punctuation">,</span> size<span class="punctuation">,</span> prob<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>参数</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code> <code>q</code></td>
<td>整数分位数点。若输入非整数，<code>dbinom</code> 返回 0；<code>pbinom</code> 自动取 <code>floor(q)</code> 计算。</td>
</tr>
<tr>
<td><code>p</code></td>
<td>概率值向量，范围必须在 [0, 1] 之间。</td>
</tr>
<tr>
<td><code>n</code></td>
<td>生成的随机数数量。若输入向量（如 <code>n = c(2,3)</code>），实际生成 <code>sum(n)</code> 个随机数。</td>
</tr>
<tr>
<td><code>size</code></td>
<td>试验次数（非负整数），若为小数会自动截断为整数。</td>
</tr>
<tr>
<td><code>prob</code></td>
<td>单次试验成功概率，范围 [0, 1]。若输入负数或 &gt;1 返回 <code>NaN</code>。</td>
</tr>
<tr>
<td><code>log</code> <code>log.p</code></td>
<td>逻辑值。若为 <code>TRUE</code>，概率以自然对数形式输入/输出（例如 <code>log(0.05)</code>）。</td>
</tr>
<tr>
<td><code>lower.tail</code></td>
<td>逻辑值。若为 <code>TRUE</code>（默认），计算 <code>P(X ≤ x)</code> 或 <code>P(X ≤ q)</code>；否则计算 <code>P(X &gt; x)</code> 或 <code>P(X &gt; q)</code>。</td>
</tr>
</tbody>
</table>
<h3 id="2-2-随机抽样函数-sample">2.2 随机抽样函数 sample</h3>
<p><strong>格式</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sample<span class="punctuation">(</span>x<span class="punctuation">,</span> size<span class="punctuation">,</span> replace <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> prob <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>参数</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td>抽样来源。可以是向量或单个整数：若为向量，直接从中抽样；若为整数 <code>n</code> ，等价于从 <code>1:n</code> 抽样</td>
</tr>
<tr>
<td><code>size</code></td>
<td>抽样数量。必须为非负整数，且当 <code>replace=FALSE</code> 时，<code>size ≤ length(x)</code></td>
</tr>
<tr>
<td><code>replace</code></td>
<td>是否放回抽样。默认 <code>FALSE</code>（无放回）；<code>TRUE</code> 时为有放回抽样</td>
</tr>
<tr>
<td><code>prob</code></td>
<td>权重向量。指定每个元素的抽样概率（自动归一化），需与 <code>x</code> 等长。默认等概率抽样</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>关键细节</strong></p>
<ol>
<li>当 <code>x</code> 为整数时的特殊行为</li>
</ol>
  <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sample<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span>          <span class="comment"># 等价于从 1:5 中无放回抽3个数（如 2,4,1）</span></span><br><span class="line">sample<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span>       <span class="comment"># 从单元素向量 5 中有放回抽3次（需设置 replace=TRUE）</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>权重概率：若 <code>prob</code> 的和不为1，会自动归一化处理</li>
</ol>
  <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sample<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span> replace<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> prob<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span>  <span class="comment"># &quot;A&quot;出现概率为 3/(3+1)=75%</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>边界条件限制：<code>size</code> 在无放回时一定要比 <code>x</code> 的长度小</li>
</ol>
  <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">15</span><span class="punctuation">,</span> replace<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span>   <span class="comment"># 允许（有放回）</span></span><br><span class="line">sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">15</span><span class="punctuation">,</span> replace<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span>  <span class="comment"># 报错</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-随机种子-set-seed">2.3 随机种子 set.seed()</h3>
<p>在电脑上生成随机数字时，生成的数字并不是真正的随机数，它们叫做伪随机数 (pseudo random number)。当从任意分布模拟随机数字时，设置随机数字生成器种子 (seed) 是非常重要的。设置随机种子使得实验结果可复现。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># n 指定一个整数</span></span><br><span class="line">set.seed<span class="punctuation">(</span>n<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>当设置随机种子后，随机结果将会相同</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">set.seed<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">rnorm<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">)</span> <span class="comment"># [1]  0.6328626  0.4042683 -0.1061245</span></span><br><span class="line">rnorm<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">)</span> <span class="comment"># [1]  1.5952808  0.3295078 -0.8204684  0.4874291</span></span><br><span class="line"></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">rnorm<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">)</span> <span class="comment"># [1]  0.6328626  0.4042683 -0.1061245</span></span><br><span class="line">rnorm<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">)</span> <span class="comment"># [1]  1.5952808  0.3295078 -0.8204684  0.4874291</span></span><br></pre></td></tr></table></figure>
<h2 id="3-数据清洗">3 数据清洗</h2>
<p>结构化数据：表格形式的数据。每一行代表一个样本/观测，每一列对应一个变量/特征。</p>
<p><strong>创建示例数据表</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">manager <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">date0 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;10/24/08&quot;</span><span class="punctuation">,</span> <span class="string">&quot;10/28/08&quot;</span><span class="punctuation">,</span> <span class="string">&quot;10/1/08&quot;</span><span class="punctuation">,</span> <span class="string">&quot;10/12/08&quot;</span><span class="punctuation">,</span> <span class="string">&quot;5/1/09&quot;</span><span class="punctuation">)</span></span><br><span class="line">nationality <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;US&quot;</span><span class="punctuation">,</span> <span class="string">&quot;UK&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">gender <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;M&quot;</span><span class="punctuation">,</span> <span class="string">&quot;F&quot;</span><span class="punctuation">,</span> <span class="string">&quot;F&quot;</span><span class="punctuation">,</span> <span class="string">&quot;M&quot;</span><span class="punctuation">,</span> <span class="string">&quot;F&quot;</span><span class="punctuation">)</span></span><br><span class="line">age <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">32</span><span class="punctuation">,</span> <span class="number">45</span><span class="punctuation">,</span> <span class="number">25</span><span class="punctuation">,</span> <span class="number">39</span><span class="punctuation">,</span> <span class="number">99</span><span class="punctuation">)</span></span><br><span class="line">q1 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">q2 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">q3 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">q4 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">q5 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">leadership <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>manager<span class="punctuation">,</span> date0<span class="punctuation">,</span> nationality<span class="punctuation">,</span> gender<span class="punctuation">,</span> age<span class="punctuation">,</span> q1<span class="punctuation">,</span> q2<span class="punctuation">,</span> q3<span class="punctuation">,</span> q4<span class="punctuation">,</span> q5<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">leadership</span><br><span class="line"><span class="comment">#   manager    date0 nationality gender age q1 q2 q3 q4 q5</span></span><br><span class="line"><span class="comment"># 1       1 10/24/08          US      M  32  5  4  5  5  5</span></span><br><span class="line"><span class="comment"># 2       2 10/28/08          US      F  45  3  5  2  5  5</span></span><br><span class="line"><span class="comment"># 3       3  10/1/08          UK      F  25  3  5  5  5  2</span></span><br><span class="line"><span class="comment"># 4       4 10/12/08          UK      M  39  3  3  4 NA NA</span></span><br><span class="line"><span class="comment"># 5       5   5/1/09          UK      F  99  2  2  1  2  1</span></span><br></pre></td></tr></table></figure>
<h3 id="3-1-缺失数据">3.1 缺失数据</h3>
<p><code>is.na()</code> 逐个元素比较是否为空 <code>NA</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">is.na</span><span class="punctuation">(</span>leadership<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/QQ_1741851904974.png" alt=""></p>
<p>直接删除 <code>na.omit</code> 非替换操作，删除空值的行</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newdata <span class="operator">&lt;-</span> na.omit<span class="punctuation">(</span>leadership<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">newdata</span><br><span class="line"><span class="comment">#   manager    date0 nationality gender age q1 q2 q3 q4 q5</span></span><br><span class="line"><span class="comment"># 1       1 10/24/08          US      M  32  5  4  5  5  5</span></span><br><span class="line"><span class="comment"># 2       2 10/28/08          US      F  45  3  5  2  5  5</span></span><br><span class="line"><span class="comment"># 3       3  10/1/08          UK      F  25  3  5  5  5  2</span></span><br><span class="line"><span class="comment"># 5       5   5/1/09          UK      F  99  2  2  1  2  1</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>或者采用均值填充 <code>mean(leadership$age)</code></p>
</blockquote>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用中位数代替 q1 列的缺失值</span></span><br><span class="line">leadership<span class="operator">$</span>q1<span class="punctuation">[</span><span class="built_in">is.na</span><span class="punctuation">(</span>leadership<span class="operator">$</span>q1<span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> median<span class="punctuation">(</span>leadership<span class="operator">$</span>q1<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用均值代替 q2 列的缺失值</span></span><br><span class="line">leadership<span class="operator">$</span>q2<span class="punctuation">[</span><span class="built_in">is.na</span><span class="punctuation">(</span>leadership<span class="operator">$</span>q2<span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> mean<span class="punctuation">(</span>leadership<span class="operator">$</span>q2<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>其中 <code>na.rm = TRUE</code> 表示在计算均值/中位数等统计量时忽略空值。</p>
<h3 id="3-2-数据按行排序">3.2 数据按行排序</h3>
<table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">函数/方法</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">对向量排序</td>
<td style="text-align:left"><code>sort()</code></td>
<td style="text-align:left">返回排序后的值</td>
</tr>
<tr>
<td style="text-align:left">获取排序索引</td>
<td style="text-align:left"><code>order()</code></td>
<td style="text-align:left">返回排序后的索引值，用于按行排序</td>
</tr>
<tr>
<td style="text-align:left">按列升序排序</td>
<td style="text-align:left"><code>data[order(data$column), ]</code></td>
<td style="text-align:left">按指定列升序排列数据框</td>
</tr>
<tr>
<td style="text-align:left">降序排序</td>
<td style="text-align:left"><code>order(x, decreasing = TRUE)</code></td>
<td style="text-align:left">按指定列降序排列数据框</td>
</tr>
<tr>
<td style="text-align:left">处理缺失值</td>
<td style="text-align:left"><code>na.last = TRUE/FALSE</code></td>
<td style="text-align:left">控制缺失值在排序中的位置（默认放在最后）</td>
</tr>
</tbody>
</table>
<p>例如：按照 <code>age</code> 升序排序</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newdata <span class="operator">&lt;-</span> leadership<span class="punctuation">[</span>order<span class="punctuation">(</span>leadership<span class="operator">$</span>age<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>好的，用户需要整理关于R语言中选取和删除部分数据的笔记，特别是使用下标运算、列名以及subset()函数的方法。他们已经提供了一些之前的笔记结构，我需要保持一致的风格和格式。</p>
<p>首先，我需要回忆R语言中数据框的基本操作。下标运算[ , ]的使用是关键，参数可以是正数、负数、逻辑值或空。用户还提到数据框有行名和列名，可以按列名选取列。另外，subset()函数也是一个重要的方法。</p>
<p>接下来，我需要确定如何组织内容。之前的笔记有参数详解、关键细节、示例和注意事项，我应该沿用这个结构。需要解释不同的下标类型如何影响选取或删除数据，比如正数选择特定行或列，负数排除，逻辑值过滤，空表示全选。还要说明如何使用列名来选取列，以及subset()函数的参数和使用场景。</p>
<p>需要注意常见的陷阱，比如混合使用正负下标可能导致错误，逻辑值的回收机制可能引发意外结果，subset()函数在处理变量时的环境问题。还要提到drop参数的影响，避免数据框降维为向量。</p>
<p>然后，准备示例代码。例如，用正数选取行和列，用负数删除，用逻辑表达式过滤行，按列名选取，以及subset()的使用。同时提供输出结果，帮助理解。</p>
<p>最后，总结不同方法的适用场景，帮助用户根据需求选择合适的方式。确保内容清晰，结构合理，语言简洁，符合用户之前的笔记风格。</p>
<h3 id="3-3-选取-删除部分数据">3.3 选取/删除部分数据</h3>
<h4 id="3-3-1-基础方法：下标运算符">3.3.1 基础方法：下标运算符 [ ]</h4>
<p><strong>格式</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据框<span class="punctuation">[</span>行下标<span class="punctuation">,</span> 列下标<span class="punctuation">]</span>  <span class="comment"># 行和列下标可为正数、负数、逻辑值或空（保留所有行/列）</span></span><br></pre></td></tr></table></figure>
<p><strong>参数</strong></p>
<table>
<thead>
<tr>
<th>下标类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>正数</td>
<td>选取指定位置的行/列（如 <code>1:3</code> 选取前3行或前3列）</td>
</tr>
<tr>
<td>负数</td>
<td>排除指定位置的行/列（如 <code>-c(2,4)</code> 删除第2和第4行/列）</td>
</tr>
<tr>
<td>逻辑值</td>
<td>按 TRUE/FALSE 筛选行/列（如 <code>数据框$列名 &gt; 5</code> 筛选满足条件的行）</td>
</tr>
<tr>
<td>空值</td>
<td>保留所有行或列（如 <code>数据框[, 2:4]</code> 保留所有行，选取第2到4列）</td>
</tr>
<tr>
<td>列名</td>
<td>通过列名字符串筛选（如 <code>数据框[, c(&quot;列名1&quot;, &quot;列名2&quot;)]</code>）</td>
</tr>
</tbody>
</table>
<p><strong>示例</strong></p>
<ul>
<li>按照数字索引取/删除</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选取前3行和前2列</span></span><br><span class="line">df<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除第2行和第3列</span></span><br><span class="line">df<span class="punctuation">[</span><span class="operator">-</span><span class="number">2</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取所有行，仅保留第2列</span></span><br><span class="line">df<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span>      <span class="comment"># 结果可能降维为向量</span></span><br><span class="line">df<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> drop<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">]</span>  <span class="comment"># 保持数据框结构</span></span><br></pre></td></tr></table></figure>
<ul>
<li>按逻辑条件筛选行</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 筛选年龄 &gt;30 的行</span></span><br><span class="line">df<span class="punctuation">[</span>df<span class="operator">$</span>age <span class="operator">&gt;</span> <span class="number">30</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 筛选性别为女性且国籍为US的行</span></span><br><span class="line">df<span class="punctuation">[</span>df<span class="operator">$</span>gender <span class="operator">==</span> <span class="string">&quot;F&quot;</span> <span class="operator">&amp;</span> df<span class="operator">$</span>country <span class="operator">==</span> <span class="string">&quot;US&quot;</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<ul>
<li>按列名选取列</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选取指定列</span></span><br><span class="line">df<span class="punctuation">[</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;age&quot;</span><span class="punctuation">,</span> <span class="string">&quot;gender&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 排除指定列</span></span><br><span class="line">df<span class="punctuation">[</span><span class="punctuation">,</span> <span class="operator">!</span><span class="punctuation">(</span>colnames<span class="punctuation">(</span>df<span class="punctuation">)</span> <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;date&quot;</span><span class="punctuation">,</span> <span class="string">&quot;q5&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h4 id="3-3-2-subset-函数">3.3.2 subset() 函数</h4>
<p><strong>格式</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subset<span class="punctuation">(</span>数据框<span class="punctuation">,</span> subset<span class="operator">=</span>行筛选条件<span class="punctuation">,</span> select<span class="operator">=</span>列筛选条件<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>参数</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>subset</code></td>
<td>逻辑表达式，筛选符合条件的行（如 <code>age &gt; 30</code>）</td>
</tr>
<tr>
<td><code>select</code></td>
<td>指定要保留的列，支持列名或列位置（如 <code>c(&quot;age&quot;, &quot;gender&quot;)</code> 或 <code>2:4</code>）</td>
</tr>
</tbody>
</table>
<p><strong>示例</strong></p>
<ul>
<li>筛选年龄 &gt; 30 且性别为男性的行，保留年龄和性别列</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subset<span class="punctuation">(</span>df<span class="punctuation">,</span> subset <span class="operator">=</span> age <span class="operator">&gt;</span> <span class="number">30</span> <span class="operator">&amp;</span> gender <span class="operator">==</span> <span class="string">&quot;M&quot;</span><span class="punctuation">,</span> select <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;age&quot;</span><span class="punctuation">,</span> <span class="string">&quot;gender&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>subset()</code> 的 <code>select</code> 参数支持负列名，表示删除/不取对应的列</p>
</blockquote>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subset<span class="punctuation">(</span>数据框<span class="punctuation">,</span> select <span class="operator">=</span> <span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span>列名<span class="number">1</span><span class="punctuation">,</span> 列名<span class="number">2</span><span class="punctuation">,</span> ...<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="3-4-添加变量-特征">3.4 添加变量/特征</h3>
<h4 id="3-4-1-直接赋值法">3.4.1 直接赋值法</h4>
<p>通过 <code>$</code> 符号直接创建新变量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算 q1 到 q5 的总和 (qsum)</span></span><br><span class="line">leadership<span class="operator">$</span>qsum <span class="operator">&lt;-</span> leadership<span class="operator">$</span>q1 <span class="operator">+</span> leadership<span class="operator">$</span>q2 <span class="operator">+</span> leadership<span class="operator">$</span>q3 <span class="operator">+</span> leadership<span class="operator">$</span>q4 <span class="operator">+</span> leadership<span class="operator">$</span>q5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 qsum 的平均值 (qmean)</span></span><br><span class="line">leadership<span class="operator">$</span>qmean <span class="operator">&lt;-</span> leadership<span class="operator">$</span>qsum <span class="operator">/</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h4 id="3-4-2-within-函数">3.4.2 within() 函数</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">leadership <span class="operator">&lt;-</span> within<span class="punctuation">(</span>leadership<span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    qsum <span class="operator">&lt;-</span> q1 <span class="operator">+</span> q2 <span class="operator">+</span> q3 <span class="operator">+</span> q4 <span class="operator">+</span> q5 <span class="comment"># 计算总和</span></span><br><span class="line">    qmean <span class="operator">&lt;-</span> qsum <span class="operator">/</span> <span class="number">5</span> <span class="comment"># 计算平均值</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-5-合并数据集">3.5 合并数据集</h3>
<h4 id="3-5-1-基础合并函数-cbind-rbind">3.5.1 基础合并函数 cbind() rbind()</h4>
<p><code>cbind()</code>：按列合并</p>
<ul>
<li>
<p>语法</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cbind<span class="punctuation">(</span>数据框<span class="number">1</span><span class="punctuation">,</span> 数据框<span class="number">2</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>示例</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df1 <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>ID <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span> Name <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span> <span class="string">&quot;B&quot;</span><span class="punctuation">,</span> <span class="string">&quot;C&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">df2 <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>Age <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span> <span class="number">25</span><span class="punctuation">,</span> <span class="number">30</span><span class="punctuation">)</span><span class="punctuation">,</span> Score <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">85</span><span class="punctuation">,</span> <span class="number">90</span><span class="punctuation">,</span> <span class="number">88</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">combined_col <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span>  <span class="comment"># 合并后列数为 df1 列数 + df2 列数</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Age</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
<td>20</td>
<td>85</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>25</td>
<td>90</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>30</td>
<td>88</td>
</tr>
</tbody>
</table>
<blockquote>
<p>若行数不同，会报错；列名重复时自动添加后缀（如 <code>Score</code> 和 <code>Score.1</code>）</p>
</blockquote>
<p><code>rbind()</code>：按行合并</p>
<ul>
<li>
<p>语法</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbind<span class="punctuation">(</span>数据框<span class="number">1</span><span class="punctuation">,</span> 数据框<span class="number">2</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>示例</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df3 <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>ID <span class="operator">=</span> <span class="number">4</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span> Name <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;D&quot;</span><span class="punctuation">,</span> <span class="string">&quot;E&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> Age <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">22</span><span class="punctuation">,</span> <span class="number">28</span><span class="punctuation">)</span><span class="punctuation">,</span> Score <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">92</span><span class="punctuation">,</span> <span class="number">80</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">combined_row <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>combined_col<span class="punctuation">,</span> df3<span class="punctuation">)</span>  <span class="comment"># 合并后行数为原两数据框行数之和</span></span><br></pre></td></tr></table></figure>
<p><strong>结果</strong>：<br>
| ID   | Name | Age  | Score |<br>
| ---- | ---- | ---- | ----- |<br>
| 1    | A    | 20   | 85    |<br>
| 2    | B    | 25   | 90    |<br>
| 3    | C    | 30   | 88    |<br>
| 4    | D    | 22   | 92    |<br>
| 5    | E    | 28   | 80    |</p>
</li>
</ul>
<blockquote>
<p>若列名不一致，会报错</p>
</blockquote>
<h4 id="3-5-2-高级合并函数-merge">3.5.2 高级合并函数 merge()</h4>
<p>根据共同列（键）合并两个数据框。</p>
<ul>
<li>
<p>语法</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">merge<span class="punctuation">(</span>数据框<span class="number">1</span><span class="punctuation">,</span> 数据框<span class="number">2</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;列名&quot;</span><span class="punctuation">,</span> <span class="built_in">all</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>核心参数</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>by</code></td>
<td>指定合并的列名（如 <code>by = &quot;ID&quot;</code>），若未指定则自动匹配同名列。</td>
</tr>
<tr>
<td><code>all.x</code></td>
<td>是否保留左表所有行（左外连接），默认 <code>FALSE</code>。</td>
</tr>
<tr>
<td><code>all.y</code></td>
<td>是否保留右表所有行（右外连接），默认 <code>FALSE</code>。</td>
</tr>
<tr>
<td><code>all</code></td>
<td><code>all = TRUE</code> 表示全外连接（保留所有行）。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>左/右/外连接：按照某列合并时，可能会存在其他列个数不匹配。采用左外连接，则保留左表所有行，右表不足则复制，填入空值；采用右外连接，则保留右表所有行，左表不足则复制，填入空值；采用全连接，则保留左右表所有行，不足则复制，填入空值。</p>
</blockquote>
<ul>
<li>
<p>示例</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">orders <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>OrderID <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">101</span><span class="punctuation">,</span> <span class="number">102</span><span class="punctuation">,</span> <span class="number">103</span><span class="punctuation">)</span><span class="punctuation">,</span> CustomerID <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">customers <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>CustomerID <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span> Name <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span> <span class="string">&quot;B&quot;</span><span class="punctuation">,</span> <span class="string">&quot;C&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内连接（默认）取交集，[1，2，4] 和 [1, 2, 3] 只有 [1, 2] 相交</span></span><br><span class="line">inner_join <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>orders<span class="punctuation">,</span> customers<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;CustomerID&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>内连接结果</p>
<table>
<thead>
<tr>
<th>CustomerID</th>
<th>OrderID</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>101</td>
<td>A</td>
</tr>
<tr>
<td>2</td>
<td>102</td>
<td>B</td>
</tr>
</tbody>
</table>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 左外连接，左表的 [1, 2, 4] 都保留，则多出来的无法匹配的留空</span></span><br><span class="line">left_join <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>orders<span class="punctuation">,</span> customers<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;CustomerID&quot;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>左外连接结果</p>
<table>
<thead>
<tr>
<th>CustomerID</th>
<th>OrderID</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>101</td>
<td>A</td>
</tr>
<tr>
<td>2</td>
<td>102</td>
<td>B</td>
</tr>
<tr>
<td>4</td>
<td>103</td>
<td>NA</td>
</tr>
</tbody>
</table>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.iskage.online">isKage</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.iskage.online/posts/502a59cb.html">https://blog.iskage.online/posts/502a59cb.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.iskage.online" target="_blank">isKage`Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/R-%E8%AF%AD%E8%A8%80/">R 语言</a><a class="post-meta__tags" href="/tags/%E7%BB%9F%E8%AE%A1%E8%BD%AF%E4%BB%B6/">统计软件</a><a class="post-meta__tags" href="/tags/R-programming/">R programming</a></div><div class="post-share"><div class="social-share" data-image="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/c69bd6a6.html" title="栈 Stack 和回溯法 Backtracking"><img class="cover" src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/python._logo.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">栈 Stack 和回溯法 Backtracking</div></div><div class="info-2"><div class="info-item-1">本章介绍栈数据类型，包括栈的概念、如何用 Python 实现栈（数组、链表）、栈的实际使用（数据逆置、匹配问题、算数计算原理、函数调用等原理）以及回溯法的概念和使用，包括常见案例（全排列、子集问题、求和谜题以及著名的 N 皇后问题）。</div></div></div></a><a class="pagination-related" href="/posts/416d50d7.html" title="链表 (2) 含有位置信息的链表、链表的插入排序和 More-To-Front 启发式算法"><img class="cover" src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/python._logo.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">链表 (2) 含有位置信息的链表、链表的插入排序和 More-To-Front 启发式算法</div></div><div class="info-2"><div class="info-item-1">在单向链表、循环链表和双向链表的基础上，引入位置信息，定义基于链表的位置列表数据类型，并基于链表实现了插入排序。</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/d4da4a15.html" title="统计软件 R 语言学习笔记 (1) R 语言基本介绍"><img class="cover" src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-20</div><div class="info-item-2">统计软件 R 语言学习笔记 (1) R 语言基本介绍</div></div><div class="info-2"><div class="info-item-1">本文介绍如何下载 R 语言和软件 RStudio 以及 R 语言的基本语法、R 的程序包、R 的对象。具体介绍了如何下载包、管理包、加载包和删除包，以及对象的命名和删除方法，和对象的属性和类别。</div></div></div></a><a class="pagination-related" href="/posts/a6f8df4a.html" title="统计软件 R 语言学习笔记 (2) R 语言初步：常见对象和数据的输入输出"><img class="cover" src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-27</div><div class="info-item-2">统计软件 R 语言学习笔记 (2) R 语言初步：常见对象和数据的输入输出</div></div><div class="info-2"><div class="info-item-1">本文详细介绍了 R 语言常见的对象类型，包括向量、矩阵、数据框等。同时介绍了如何读取数据和输出数据，包括 read.table 函数等。</div></div></div></a><a class="pagination-related" href="/posts/8bcfe1ac.html" title="统计软件 R 语言学习笔记 (3) R 语言初步：基本运算、常见操作和控制流"><img class="cover" src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-06</div><div class="info-item-2">统计软件 R 语言学习笔记 (3) R 语言初步：基本运算、常见操作和控制流</div></div><div class="info-2"><div class="info-item-1">本章介绍了 R 语言中常见的运算和操作（例如索引），以及针对不同数据类型的不同操作函数（例如 apply 函数）。同时介绍了 R 语言控制流（if-else 条件执行、for while repeat 循环结构）的实现。</div></div></div></a><a class="pagination-related" href="/posts/86c8422a.html" title="统计软件 R 语言学习笔记 (6) 统计图表"><img class="cover" src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-26</div><div class="info-item-2">统计软件 R 语言学习笔记 (6) 统计图表</div></div><div class="info-2"><div class="info-item-1">本章介绍了常见的统计图表和其 R 语言实现方法：频数频率图表、条形/柱状图、列联表、饼图；直方图、箱线图、散点图。同时介绍了 R 语言绘图的范式：高级&低级绘图函数、常见参数设置、子图、保存图片的方法。</div></div></div></a><a class="pagination-related" href="/posts/ccdaeb5f.html" title="统计软件 R 语言学习笔记 (5) 统计数据类型和日期时间数据"><img class="cover" src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-25</div><div class="info-item-2">统计软件 R 语言学习笔记 (5) 统计数据类型和日期时间数据</div></div><div class="info-2"><div class="info-item-1">本章介绍统计数据的计量尺度（定类、定序、定距、定比），重点介绍了一种特殊的数据类型：时间和日期。并讲解了一些常用时间日期函数：`strptime` `as.Date` ，除此之外还介绍了时间 Times 类型的两种类型 `POSIXct` 和 `POSIXlt` 。</div></div></div></a><a class="pagination-related" href="/posts/bae67ad7.html" title="统计软件 R 语言学习笔记 (9) 回归分析：简单线性回归"><img class="cover" src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-17</div><div class="info-item-2">统计软件 R 语言学习笔记 (9) 回归分析：简单线性回归</div></div><div class="info-2"><div class="info-item-1">本章介绍回顾分析的原理，从单变量的简单线性回归为入门，介绍相关理论。利用 R 语言实现线性回归模型的分析。</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/avatar_new.PNG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">isKage</div><div class="author-info-description">欢迎来到 isKage 的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">65</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/isKage"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon faa-parent animated-hover" href="https://github.com/isKage" target="_blank" title="Github"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a><a class="social-icon faa-parent animated-hover" href="mailto:kageshu211@gmail.com" target="_blank" title="Email"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-mail"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://www.zhihu.com/people/iskage" target="_blank" title="知乎"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhihu"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://www.kaggle.com/iskage" target="_blank" title="Kaggle"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-kaggle_"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客，我会定期分享学习笔记。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">R 语言初步 (3) 自定义函数、简单模拟与数据清洗</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text">1 自定义函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="toc-text">1.1 函数定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%BC%A0%E5%8F%82%E6%96%B9%E5%BC%8F"><span class="toc-text">1.2 传参方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%A4%BA%E4%BE%8B"><span class="toc-text">1.3 示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%AE%80%E5%8D%95%E6%A8%A1%E6%8B%9F"><span class="toc-text">2 简单模拟</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%9C%89%E5%85%B3%E7%BB%9F%E8%AE%A1%E5%88%86%E5%B8%83%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-text">2.1 有关统计分布的函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83"><span class="toc-text">2.1.1 正态分布</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-Poisson-%E5%88%86%E5%B8%83"><span class="toc-text">2.1.2 Poisson 分布</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-3-%E4%BA%8C%E9%A1%B9%E5%88%86%E5%B8%83"><span class="toc-text">2.1.3 二项分布</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E9%9A%8F%E6%9C%BA%E6%8A%BD%E6%A0%B7%E5%87%BD%E6%95%B0-sample"><span class="toc-text">2.2 随机抽样函数 sample</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E9%9A%8F%E6%9C%BA%E7%A7%8D%E5%AD%90-set-seed"><span class="toc-text">2.3 随机种子 set.seed()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="toc-text">3 数据清洗</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE"><span class="toc-text">3.1 缺失数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%95%B0%E6%8D%AE%E6%8C%89%E8%A1%8C%E6%8E%92%E5%BA%8F"><span class="toc-text">3.2 数据按行排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E9%80%89%E5%8F%96-%E5%88%A0%E9%99%A4%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE"><span class="toc-text">3.3 选取&#x2F;删除部分数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E5%9F%BA%E7%A1%80%E6%96%B9%E6%B3%95%EF%BC%9A%E4%B8%8B%E6%A0%87%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">3.3.1 基础方法：下标运算符 [ ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-subset-%E5%87%BD%E6%95%B0"><span class="toc-text">3.3.2 subset() 函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E6%B7%BB%E5%8A%A0%E5%8F%98%E9%87%8F-%E7%89%B9%E5%BE%81"><span class="toc-text">3.4 添加变量&#x2F;特征</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-%E7%9B%B4%E6%8E%A5%E8%B5%8B%E5%80%BC%E6%B3%95"><span class="toc-text">3.4.1 直接赋值法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-within-%E5%87%BD%E6%95%B0"><span class="toc-text">3.4.2 within() 函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%90%88%E5%B9%B6%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-text">3.5 合并数据集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-%E5%9F%BA%E7%A1%80%E5%90%88%E5%B9%B6%E5%87%BD%E6%95%B0-cbind-rbind"><span class="toc-text">3.5.1 基础合并函数 cbind() rbind()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-2-%E9%AB%98%E7%BA%A7%E5%90%88%E5%B9%B6%E5%87%BD%E6%95%B0-merge"><span class="toc-text">3.5.2 高级合并函数 merge()</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/e59b7364.html" title="搜索树（1）：二叉搜索树、平衡搜索树、AVL 树"><img src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/python._logo.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="搜索树（1）：二叉搜索树、平衡搜索树、AVL 树"/></a><div class="content"><a class="title" href="/posts/e59b7364.html" title="搜索树（1）：二叉搜索树、平衡搜索树、AVL 树">搜索树（1）：二叉搜索树、平衡搜索树、AVL 树</a><time datetime="2025-04-19T00:16:00.000Z" title="发表于 2025-04-19 08:16:00">2025-04-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bae67ad7.html" title="统计软件 R 语言学习笔记 (9) 回归分析：简单线性回归"><img src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/r_prog.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="统计软件 R 语言学习笔记 (9) 回归分析：简单线性回归"/></a><div class="content"><a class="title" href="/posts/bae67ad7.html" title="统计软件 R 语言学习笔记 (9) 回归分析：简单线性回归">统计软件 R 语言学习笔记 (9) 回归分析：简单线性回归</a><time datetime="2025-04-17T06:44:00.000Z" title="发表于 2025-04-17 14:44:00">2025-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f16f683a.html" title="有序映射：排序检索表、跳跃表"><img src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/python._logo.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="有序映射：排序检索表、跳跃表"/></a><div class="content"><a class="title" href="/posts/f16f683a.html" title="有序映射：排序检索表、跳跃表">有序映射：排序检索表、跳跃表</a><time datetime="2025-04-16T00:16:00.000Z" title="发表于 2025-04-16 08:16:00">2025-04-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4761994e.html" title="SQL 自学笔记（13）视图"><img src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/mysql.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL 自学笔记（13）视图"/></a><div class="content"><a class="title" href="/posts/4761994e.html" title="SQL 自学笔记（13）视图">SQL 自学笔记（13）视图</a><time datetime="2025-04-15T09:24:00.000Z" title="发表于 2025-04-15 17:24:00">2025-04-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ab7a595d.html" title="映射 (Map) 与 哈希 (Hash)"><img src="https://blog-iskage.oss-cn-hangzhou.aliyuncs.com/images/python._logo.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="映射 (Map) 与 哈希 (Hash)"/></a><div class="content"><a class="title" href="/posts/ab7a595d.html" title="映射 (Map) 与 哈希 (Hash)">映射 (Map) 与 哈希 (Hash)</a><time datetime="2025-04-11T00:16:00.000Z" title="发表于 2025-04-11 08:16:00">2025-04-11</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By isKage</div><div class="footer_custom_text">Welcome to my blog, have a nice day!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css')
    if (true) {
      await btf.getScript('https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})()</script></div><div class="aplayer no-destroy" data-id="9413886021" data-server="tencent" data-type="playlist"   data-order="list" data-fixed="true" data-preload="auto" data-autoplay="false" data-mutex="true" ></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script async src="/js/ali_font.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '100ms');
    arr[i].setAttribute('data-wow-offset', '25');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '100ms');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('article-sort-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__slideInRight');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --></body></html>